<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Gest√£o de Demonstrativos</title>
    <!-- Bootstrap CSS via CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      :root {
        --bg-color: #f8f9fa;
        --surface-color: #ffffff;
        --text-color: #212529;
        --muted-text: #6c757d;
        --border-color: #dee2e6;
        --navbar-bg: #ffffff;
        --navbar-text: #212529;
        --link-color: #007bff;
        --link-hover: #0056b3;
        --accent: #007bff;
        --accent-contrast: #ffffff;
        --alert-info-bg: #e9f5ff;
        --alert-info-border: #b8e0ff;
        --alert-info-text: #0c5460;
        --table-header: #e9ecef;
        --positive: #2e7d32;
        --negative: #c62828;
        --neutral: #6c757d;
      }

      body {
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.2s ease, color 0.2s ease;
      }

      body.dark-mode {
        --bg-color: #0f141a;
        --surface-color: #1c252f;
        --text-color: #e6e9ed;
        --muted-text: #c7ced6;
        --border-color: #33404c;
        --navbar-bg: #1c252f;
        --navbar-text: #e6e9ed;
        --link-color: #64b5f6;
        --link-hover: #90caf9;
        --accent: #64b5f6;
        --accent-contrast: #0f141a;
        --alert-info-bg: #16344a;
        --alert-info-border: #215578;
        --alert-info-text: #d1e7ff;
        --table-header: #233040;
        --positive: #81c784;
        --negative: #ef9a9a;
        --neutral: #c7ced6;
      }

      .navbar {
        background-color: var(--navbar-bg) !important;
        border-bottom: 1px solid var(--border-color);
      }

      .navbar .navbar-brand,
      .navbar .nav-link,
      .navbar .navbar-toggler {
        color: var(--navbar-text) !important;
      }

      .navbar-light .navbar-toggler {
        border-color: var(--border-color);
      }

      .navbar-light .navbar-toggler-icon {
        filter: invert(0);
      }

      body.dark-mode .navbar-light .navbar-toggler-icon {
        filter: invert(1);
      }

      .navbar .nav-link:hover,
      .navbar .navbar-brand:hover {
        color: var(--link-hover) !important;
      }

      .container {
        background-color: var(--surface-color);
        border: 1px solid var(--border-color);
        border-radius: 0.5rem;
        padding: 1.5rem;
      }

      a {
        color: var(--link-color);
      }

      a:hover {
        color: var(--link-hover);
      }

      .form-control,
      .form-control-file,
      .custom-select,
      .form-control:focus,
      .form-control-file:focus,
      .custom-select:focus {
        background-color: var(--surface-color);
        color: var(--text-color);
        border-color: var(--border-color);
      }

      .custom-file-label {
        background-color: var(--surface-color);
        color: var(--text-color);
        border: 1px solid var(--border-color);
      }

      .custom-file-input:focus ~ .custom-file-label,
      .custom-file:hover .custom-file-label {
        border-color: var(--accent);
        box-shadow: 0 0 0 0.2rem rgba(100, 181, 246, 0.25);
      }

      .custom-file-label::after {
        background-color: var(--accent);
        color: var(--accent-contrast);
        border-left: 1px solid var(--border-color);
      }

      .custom-file:hover .custom-file-label::after,
      .custom-file-input:focus ~ .custom-file-label::after {
        background-color: var(--link-hover);
        color: var(--accent-contrast);
      }

      .form-check-label,
      label {
        color: var(--text-color);
      }

      .btn-primary {
        background-color: var(--accent);
        border-color: var(--accent);
        color: var(--accent-contrast);
      }

      .btn-primary:hover,
      .btn-primary:focus {
        background-color: var(--link-hover);
        border-color: var(--link-hover);
        color: var(--accent-contrast);
      }

      .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
      }

      .btn-danger:hover,
      .btn-danger:focus {
        background-color: #c82333;
        border-color: #bd2130;
      }

      .table-custom {
        background-color: var(--surface-color);
        color: var(--text-color);
      }

      .table-custom thead th {
        background-color: var(--table-header);
        color: var(--text-color);
        border-color: var(--border-color);
      }

      .table-custom td,
      .table-custom th {
        border-color: var(--border-color);
      }

      .table-striped.table-custom tbody tr:nth-of-type(odd) {
        background-color: rgba(0, 0, 0, 0.025);
      }

      body.dark-mode .table-striped.table-custom tbody tr:nth-of-type(odd) {
        background-color: rgba(255, 255, 255, 0.035);
      }

      .alert-info {
        color: var(--alert-info-text);
        background-color: var(--alert-info-bg);
        border-color: var(--alert-info-border);
      }

      .text-muted {
        color: var(--muted-text) !important;
      }

      .theme-toggle {
        color: var(--text-color);
      }

      .custom-control-input:checked ~ .custom-control-label::before {
        border-color: var(--accent);
        background-color: var(--accent);
      }
      .custom-control-input:focus ~ .custom-control-label::before {
        box-shadow: 0 0 0 0.2rem rgba(100, 181, 246, 0.25);
      }

      .btn-outline-secondary {
        color: var(--text-color);
        border-color: var(--border-color);
      }

      .btn-outline-secondary:hover,
      .btn-outline-secondary:focus,
      .btn-outline-secondary:active,
      .btn-outline-secondary:not(:disabled):not(.disabled).active,
      .btn-outline-secondary:not(:disabled):not(.disabled):active {
        color: var(--accent-contrast);
        background-color: var(--accent);
        border-color: var(--accent);
      }

      .dropdown-menu {
        background-color: var(--surface-color);
        color: var(--text-color);
        border: 1px solid var(--border-color);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.05);
      }

      .dropdown-menu .form-check-label {
        color: var(--text-color);
      }

      .dropdown-menu .form-check-input:checked {
        background-color: var(--accent);
        border-color: var(--accent);
      }

      .summary-card {
        background: var(--surface-color);
        border: 1px solid var(--border-color);
        border-radius: 0.5rem;
        padding: 1rem;
        box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.05);
      }

      .variation-badge {
        padding: 0.25rem 0.5rem;
        border-radius: 999px;
        font-size: 0.85rem;
        font-weight: 600;
        border: 1px solid var(--border-color);
        background: rgba(0, 0, 0, 0.02);
      }

      .variation-positive {
        color: var(--positive);
        border-color: var(--positive);
      }

      .variation-negative {
        color: var(--negative);
        border-color: var(--negative);
      }

      .variation-neutral {
        color: var(--neutral);
        border-color: var(--border-color);
      }

      .variation-text {
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light mb-4">
      <a class="navbar-brand" href="{{ request.url_for('index') }}">Demonstrativos</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="{{ request.url_for('index') }}">Upload</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ request.url_for('consulta_get') }}">Consulta</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ request.url_for('dashboard_totais') }}">Dashboard</a>
          </li>
        </ul>
        <div class="ml-auto d-flex align-items-center">
          <div class="custom-control custom-switch theme-toggle">
            <input type="checkbox" class="custom-control-input" id="themeToggle">
            <label class="custom-control-label" for="themeToggle">Modo escuro</label>
          </div>
        </div>
      </div>
    </nav>
    <div class="container">
      {% block content %}{% endblock %}
    </div>
    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      (function() {
        var body = document.body;
        var toggle = document.getElementById('themeToggle');
        var storedTheme = localStorage.getItem('theme');

        if (storedTheme === 'dark') {
          body.classList.add('dark-mode');
        }

        if (toggle) {
          toggle.checked = body.classList.contains('dark-mode');
          toggle.addEventListener('change', function() {
            var useDark = toggle.checked;
            body.classList.toggle('dark-mode', useDark);
            localStorage.setItem('theme', useDark ? 'dark' : 'light');
          });
        }

        var fileInputs = document.querySelectorAll('.custom-file-input');
        fileInputs.forEach(function(input) {
          var label = input.nextElementSibling;
          if (!label) {
            return;
          }

          var defaultText = label.textContent.trim() || 'Selecione arquivos PDF';
          label.dataset.defaultLabel = defaultText;

          input.addEventListener('change', function() {
            var files = Array.prototype.slice.call(input.files || []);
            var names = files.map(function(file) { return file.name; });
            label.textContent = names.length ? names.join(', ') : label.dataset.defaultLabel;
          });
        });
      })();
    </script>
  </body>
</html>
